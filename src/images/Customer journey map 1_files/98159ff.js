(window.webpackJsonp=window.webpackJsonp||[]).push([[111,174],{1011:function(t,e,r){},1031:function(t,e,r){"use strict";var o=r(993).a,n=(r(1063),r(9)),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"workspace-subheader"},[r("div",{staticClass:"workspace-subheader__title"},[t._v("\n    "+t._s(t.title)+"\n  ")]),t._v(" "),t.description||t.hasSlotData?r("div",{staticClass:"workspace-subheader__wrap"},[r("div",{directives:[{name:"uhtml",rawName:"v-uhtml",value:t.description,expression:"description"}],staticClass:"workspace-subheader__description"}),t._v(" "),r("div",{staticClass:"workspace-subheader__slot"},[t._t("default")],2)]):t._e()])}),[],!1,null,"00aceca4",null);e.a=component.exports},1063:function(t,e,r){"use strict";r(1011)},1940:function(t,e,r){"use strict";(function(t){r(10);var o=r(3),n=(r(548),r(8)),c=r(11),l=r(351),d=r(146),m=r(3428),h=r(995),_=r(346),v=r(349),w=r(1031);function f(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function k(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?f(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):f(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}const C={superAdmin:n.roles.workspace.superAdmin,workspaceAdmin:n.roles.workspace.workspaceAdmin,billingManager:n.roles.workspace.billingManager,contributor:n.roles.workspace.contributor};e.a={name:"WorkspacesPage",components:{UserRow:m.a,PermissionControl:_.a,PermissionControlTooltip:v.a,WorkspaceSubheader:w.a},mixins:[h.a,l.validationMixin],transition:"page-static",data:()=>({name:null,statuses:n.workspaceMembershipStatuses,sortBy:"email",sortOrder:"desc",selectedUsersIds:[],summaryColorAndTitle:{cjm:{title:"Customer Journey Maps",color:"#CFA7FF"},persona:{title:"Personas",color:"#56EBC4"},"impact-map":{title:"Impact Maps",color:"#FF7DC4"}}}),async fetch(e){let{store:r,params:o,error:n}=e;try{this.isAdminRole&&await r.dispatch("memberships/fetchMemberships",{workspaceId:o.workspaceId})}catch(e){n({statusCode:t.get(e,"response.status"),message:t.get(e,"response.data.message")})}},computed:k(k(k(k(k(k({},Object(c.e)("auth",["user"])),Object(c.e)("memberships",["memberships"])),Object(c.c)("memberships",["currentWorkspaceMemberships"])),Object(c.c)("subscriptions",["currentSubscriptionQuantity","currentSubscription","currentPlanType"])),Object(c.c)("workspaces",["currentWorkspaceId","currentWorkspace","currentWorkspaceName","summaryWithTitlesAndColor","isSuperAdmin","isAdminRole","currentWorkspaceContributors","currentWorkspaceViewers","currentWorkspaceAllUsers","activeFilter","currentUserMembership"])),{},{currentContributors(){return this.memberships.filter((t=>t.roles.includes(n.roles.workspace.contributor)))},remainingContributorsQuantity(){return this.currentSubscriptionQuantity-this.currentContributors.length},adminsCount(){return t.flatMap(this.memberships,(t=>t.roles)).filter((t=>t===n.roles.workspace.superAdmin)).length},filteredUsers(){switch(this.activeFilter){default:case"all":return this.currentWorkspaceAllUsers;case"contributor":return this.currentWorkspaceContributors;case"viewer":return this.currentWorkspaceViewers}}}),created(){this.name=this.currentWorkspaceName},methods:k(k(k(k(k({},Object(c.b)("workspaces",["updateWorkspace","currentWorkspaceMembership","changeFilter"])),Object(c.b)("memberships",["fetchMemberships","deleteMembership"])),Object(c.d)("workspaces",["updateCurrentWorkspace"])),Object(c.d)("ui",["setSuccess"])),{},{async _updateWorkspace(){try{this.$tracker.trackWorkspaceRename({workspaceId:this.currentWorkspace.id,oldWorkspaceName:this.currentWorkspaceName,newWorkspaceName:this.name}),this.updateWorkspace({name:this.name,id:this.currentWorkspace.id}),this.setSuccess({text:"Workspace was successfully updated"}),this.$v.$reset()}catch(t){this.setError({error:t})}},async _deleteMembership(t){try{await this.deleteMembership({membershipId:t,workspaceId:this.currentWorkspace.id}),this.setSuccess({text:"Membership was successfully removed"})}catch(t){this.setError({error:t})}},getSortIconName(header){return this.sortBy===header?"desc"===this.sortOrder?"sort-desc":"sort-asc":"sort-indeterminate"},changeSort(t){this.sortBy===t?this.sortOrder="desc"===this.sortOrder?"asc":"desc":(this.sortBy=t,this.sortOrder="desc")},isRole:(t,e)=>t.includes(C[e]),isLastAdmin(t){return t.roles.includes(n.roles.workspace.superAdmin)&&this.adminsCount<=1},canRemoveMembership(t){return!this.isLastAdmin(t)&&!t.isPersonal&&this.$can("delete",t)},tableFilterClasses(filter){return{"ws-filter__list-item":!0,"ws-filter__list-item--active":filter===this.activeFilter}},exportWsUsersData(){this.$tracker.trackWorkspaceDownloadCsv({type:"Users"}),window.open("/api/workspaces/".concat(this.currentWorkspace.id,"/memberships.csv"))},exportSummaryData(){this.$tracker.trackWorkspaceDownloadCsv({type:"Summary"}),window.open("/api/workspaces/".concat(this.currentWorkspace.id,"/summary.csv"))}}),validations:{name:{required:d.required,maxLength:Object(d.maxLength)(25)}}}}).call(this,r(12))},1941:function(t,e,r){"use strict";(function(t){r(10);var o=r(3),n=r(82),c=r(11);function l(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,r)}return e}function d(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?l(Object(source),!0).forEach((function(e){Object(o.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):l(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}e.a={name:"UserRow",props:{item:{type:Object,required:!0},index:{type:Number,required:!0},canRemoveMembership:{type:Boolean,required:!0,default:!1}},computed:d(d({},Object(c.c)("auth",["userEmail"])),Object(c.c)("workspaces",["currentWorkspace"])),methods:{showEmailTooltip(t,e){(e.length>23||e===this.userEmail)&&this.$emit("show-tooltip",{text:e,el:t.target})},getRolesList(t){const e={"workspace-admin":"WA","billing-manager":"BM","super-admin":"SA"},r=[];let o="";return t.forEach((t=>{e[t]?r.push(e[t]):o+=t[0].toUpperCase()+t.slice(1)})),r.length>0&&(o="Admin (".concat(r.join("|"),"), ").concat(o)),o},getFormatDate:(t,e)=>"invited"===t.status?"createdAt"===e?"Invited":'<span class="long-dash">—</span>':Object(n.a)(new Date(t[e]),"MMM dd, yyyy HH:mm"),getArtifactCount:(e,r)=>t.get(e,r,0)}}}).call(this,r(12))},2331:function(t,e,r){},2332:function(t,e,r){},3180:function(t,e,r){"use strict";r(2331)},3181:function(t,e,r){"use strict";r(2332)},3428:function(t,e,r){"use strict";var o=r(1941).a,n=(r(3180),r(9)),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"dashboard-table__tr dashboard-table__row",class:{"is-even":t.index%2==0,"is-odd":t.index%2==1}},[r("div",{staticClass:"dashboard-table__td dashboard-item-email"},[r("u-avatar",{staticClass:"dashboard-item-avatar",attrs:{"avatar-size":"33px",avatar:t.item.avatar}}),t._v(" "),r("u-email",{attrs:{email:t.item.email,"max-width":t.item.email===t.userEmail?"135px":"182px","max-length":16},nativeOn:{mouseenter:function(e){return t.showEmailTooltip(e,t.item.email)},mouseleave:function(e){return t.$emit("close-tooltip")}}}),t._v(" "),t.item.email===t.userEmail?r("strong",[t._v(" (you)")]):t._e()],1),t._v(" "),r("div",{staticClass:"dashboard-table__td"},[t._v("\n    "+t._s(t.getRolesList(t.item.roles))+"\n  ")]),t._v(" "),r("div",{staticClass:"dashboard-table__td user-artifacts"},[r("span",{staticClass:"user-artifacts__cjm"},[t._v(t._s(t.getArtifactCount(t.item.artifactCounts,"cjm")))]),t._v(" "),r("span",{staticClass:"user-artifacts__personas"},[t._v(t._s(t.getArtifactCount(t.item.artifactCounts,"personas")))]),t._v(" "),r("span",{staticClass:"user-artifacts__im"},[t._v(t._s(t.getArtifactCount(t.item.artifactCounts,"im")))])]),t._v(" "),r("div",{staticClass:"dashboard-table__td user-session"},[t._v("\n    "+t._s(t.item.signInCount||0)+"\n  ")]),t._v(" "),r("div",{staticClass:"dashboard-table__td"},[t._v("\n    "+t._s(t.getFormatDate(t.item,"createdAt"))+"\n  ")]),t._v(" "),r("div",{directives:[{name:"uhtml",rawName:"v-uhtml",value:t.getFormatDate(t.item,"updatedAt"),expression:"getFormatDate(item, 'updatedAt')"}],staticClass:"dashboard-table__td"}),t._v(" "),r("div",{staticClass:"dashboard-table__td"},[r("div",{staticClass:"dashboard-table_btn-wrapper"},[t.$can("update",t.item)&&"active"===t.item.status?r("u-btn",{staticClass:"row-action-btn",attrs:{"icon-size":"16",icon:"edit",href:"/workspace/"+t.currentWorkspace.id+"/membership/"+t.item.id},nativeOn:{mouseenter:function(e){return t.$emit("show-tooltip",{text:"Edit user",el:e.target})},mouseleave:function(e){return t.$emit("close-tooltip")}}}):t._e()],1),t._v(" "),t.canRemoveMembership?r("u-btn",{staticClass:"row-action-btn",attrs:{"icon-size":"18",icon:"delete"},on:{click:function(e){return e.stopPropagation(),t.$emit("removeMember",t.item.id)}},nativeOn:{mouseenter:function(e){return t.$emit("show-tooltip",{text:"Delete user",el:e.target})},mouseleave:function(e){return t.$emit("close-tooltip")}}}):t._e()],1)])}),[],!1,null,null,null);e.a=component.exports},3533:function(t,e,r){"use strict";r.r(e);var o=r(1940).a,n=(r(3181),r(9)),c=r(20),l=r.n(c),d=r(110),m=r(953),component=Object(n.a)(o,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"d-flex justify-space-between"},[r("div",{staticClass:"ws-name"},[r("workspace-subheader",{attrs:{title:"Workspace Name"}}),t._v(" "),r("div",{staticClass:"ws-name__wrap"},[t.currentWorkspace&&t.currentWorkspace.id?r("permission-control",{attrs:{action:"update",model:"Workspace",instance:t.currentWorkspace},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.isCan;return[r("v-text-field",{staticClass:"ws-name__input",attrs:{label:"Workspace name","single-line":!0,id:"wsName","validate-on-blur":!0,tabindex:"1",counter:25,disabled:!o,rules:[function(){return t.$v.name.required||"Can't be blank."},function(){return t.$v.name.maxLength||"Maximum 25 characters."}]},on:{input:function(e){return t.$v.name.$touch()}},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})]}}],null,!1,1021797658)}):t._e(),t._v(" "),t._m(0)],1),t._v(" "),t.currentWorkspace&&t.currentWorkspace.id?r("permission-control",{attrs:{action:"update",model:"Workspace",instance:t.currentWorkspace},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.isCan;return[r("u-button",{attrs:{disabled:t.$v.name.$invalid||!t.$v.name.$dirty||!o},nativeOn:{click:function(e){return e.stopPropagation(),t._updateWorkspace.apply(null,arguments)}}},[t._v("\n            Update name\n          ")])]}}],null,!1,3484275082)}):t._e()],1),t._v(" "),t.isAdminRole?r("div",{staticClass:"ws-summary"},[r("div",{staticClass:"d-flex justify-space-between"},[r("workspace-subheader",{attrs:{title:"Summary"}}),t._v(" "),t.currentWorkspace&&t.currentWorkspace.id?r("permission-control",{attrs:{action:"readCsv",model:"WorkspaceMembership",instance:{workspace:t.currentWorkspace.id}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.isCan,n=e.isPermission;return[o&&n?r("a",{staticClass:"ws-summary__link",on:{click:t.exportSummaryData}},[t._v("\n              Download CSV report\n            ")]):t._e()]}}],null,!1,448497851)}):t._e()],1),t._v(" "),r("div",{staticClass:"ws-summary__item-wrapper"},t._l(t.summaryWithTitlesAndColor,(function(e){return r("div",{key:"summary-"+e.color,staticClass:"ws-summary__item",style:{"border-color":e.color}},[r("span",{staticClass:"ws-summary__item-count"},[t._v(t._s(e.count))]),t._v(" "),r("span",{staticClass:"ws-summary__item-title"},[t._v(t._s(e.title))])])})),0)]):t._e()]),t._v(" "),t.$can("readInWorkspace",{modelName:"WorkspaceMembership",workspace:t.currentWorkspace&&t.currentWorkspace.id})&&t.isAdminRole?r("div",[r("div",{staticClass:"d-flex justify-space-between"},[r("workspace-subheader",{attrs:{title:"Workspace users"}}),t._v(" "),r("permission-control",{attrs:{action:"inviteMembers",model:"WorkspaceMembership",instance:t.currentUserMembership},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.isReadonly,n=e.isPermission,c=e.isAdmin,l=e.permission;return[r("permission-control-tooltip",{attrs:{"is-admin":c,"is-disabled":n,permission:l}},[r("div",{staticClass:"invite-users"},[r("span",{staticClass:"invite-users__label"},[t._v("\n                "+t._s(t.remainingContributorsQuantity)+" of "+t._s(t.currentSubscriptionQuantity)+" contributors left\n              ")]),t._v(" "),o?t._e():r("u-button",{staticClass:"invite-users__btn",attrs:{disabled:!n},nativeOn:{click:function(e){return e.stopPropagation(),t.$router.push({path:"/workspace/"+t.currentWorkspace.id+"/invite"})}}},[t._v("\n                Invite Users\n              ")])],1)])]}}],null,!1,1766946896)})],1),t._v(" "),r("div",{staticClass:"ws-filter"},[r("ul",{staticClass:"ws-filter__list"},[r("li",{class:t.tableFilterClasses("all"),on:{click:function(e){return t.changeFilter("all")}}},[t._v("\n          All ("+t._s(t.currentWorkspaceMemberships.length)+")\n        ")]),t._v(" "),r("li",{class:t.tableFilterClasses("contributor"),on:{click:function(e){return t.changeFilter("contributor")}}},[t._v("\n          Contributors ("+t._s(t.currentWorkspaceContributors.length)+")\n        ")]),t._v(" "),r("li",{class:t.tableFilterClasses("viewer"),on:{click:function(e){return t.changeFilter("viewer")}}},[t._v("\n          Viewers ("+t._s(t.currentWorkspaceViewers.length)+")\n        ")])]),t._v(" "),t.currentWorkspace&&t.currentWorkspace.id?r("permission-control",{attrs:{action:"readCsv",model:"WorkspaceMembership",instance:{workspace:t.currentWorkspace.id}},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.isCan,n=e.isPermission;return[o&&n?r("a",{staticClass:"ws-filter__link",on:{click:t.exportWsUsersData}},[t._v("\n            Download CSV report\n          ")]):t._e()]}}],null,!1,1211673437)}):t._e()],1)]):t._e(),t._v(" "),t.isAdminRole?r("div",{staticClass:"ws-table__wrapper"},[0===t.filteredUsers.length?r("span",{staticClass:"ws-table__empty-text"},[t._v("\n      This workspace has no "+t._s("viewer"===t.activeFilter?"Viewers":"Contributers")+" yet.\n    ")]):t._e(),t._v(" "),r("u-data-table",{staticClass:"dashboard-table dashboard-table--users",attrs:{items:t.filteredUsers,"sort-by":t.sortBy,"sort-order":t.sortOrder,"item-size":60,"second-color":"#fff"},scopedSlots:t._u([{key:"headers",fn:function(){return[r("div",{staticClass:"dashboard-table__tr dashboard-table__headers"},[r("div",{staticClass:"dashboard-table__th sortable-header"},[t._v("\n            users\n            "),r("u-btn",{attrs:{"icon-size":"12",icon:t.getSortIconName("email")},on:{click:function(e){return t.changeSort("email")}}})],1),t._v(" "),r("div",{staticClass:"dashboard-table__th"},[t._v("\n            roles\n          ")]),t._v(" "),r("div",{staticClass:"dashboard-table__th"},[t._v("\n            cjm | personas | im\n          ")]),t._v(" "),r("div",{staticClass:"dashboard-table__th sortable-header"},[t._v("\n            sessions\n            "),r("u-btn",{attrs:{"icon-size":"12",icon:t.getSortIconName("signInCount")},on:{click:function(e){return t.changeSort("signInCount")}}})],1),t._v(" "),r("div",{staticClass:"dashboard-table__th sortable-header"},[t._v("\n            joined\n            "),r("u-btn",{attrs:{"icon-size":"12",icon:t.getSortIconName("createdAt")},on:{click:function(e){return t.changeSort("createdAt")}}})],1),t._v(" "),r("div",{staticClass:"dashboard-table__th sortable-header"},[t._v("\n            last seen\n            "),r("u-btn",{attrs:{"icon-size":"12",icon:t.getSortIconName("updatedAt")},on:{click:function(e){return t.changeSort("updatedAt")}}})],1),t._v(" "),r("div",{staticClass:"dashboard-table__th"},[t._v("\n            actions\n          ")])])]},proxy:!0},{key:"items",fn:function(e){var o=e.item,n=e.index;return[r("user-row",{attrs:{item:o,index:n,"can-remove-membership":t.canRemoveMembership(o)},on:{removeMember:t._deleteMembership,"show-tooltip":t.$withTooltip_showTooltip,"close-tooltip":t.$withTooltip_closeTooltip}})]}}],null,!1,1582731147)})],1):t._e(),t._v(" "),r("v-tooltip",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{bottom:"",value:t.$data.$withTooltip_tooltip,activator:t.$data.$withTooltip_tooltipEl}},[t._v("\n    "+t._s(t.$data.$withTooltip_tooltipText)+"\n  ")])],1)}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"ws-name__label"},[t._v("\n          This name will be displayed on your and your"),r("br"),t._v(" teammates' dashboards\n        ")])}],!1,null,"51a145ee",null);e.default=component.exports;l()(component,{VTextField:d.a,VTooltip:m.a})},993:function(t,e,r){"use strict";(function(t){e.a={name:"WorkspaceSubheader",components:{},props:{title:{type:String,required:!0},description:{type:String,default:""}},data:()=>({}),computed:{hasSlotData(){return t.has(this.$slots,"default")}}}}).call(this,r(12))},995:function(t,e,r){"use strict";var o=r(2);e.a={data:()=>({$withTooltip_tooltip:!1,$withTooltip_tooltipText:"",$withTooltip_tooltipEl:null,$withTooltip_tooltipProps:{},$withTooltip_tooltipTimeout:null}),methods:{$_withTooltip_clearTooltip(){this.$data.$withTooltip_tooltipText="",this.$data.$withTooltip_tooltipEl=null,this.$data.$withTooltip_tooltipProps={}},async $withTooltip_showTooltip(t){let{text:text,el:e,props:r}=t;this.$_withTooltip_clearTooltip(),await o.default.nextTick(),clearTimeout(this.$data.$withTooltip_tooltipTimeout),this.$data.$withTooltip_tooltipText=text,this.$data.$withTooltip_tooltipEl=null,this.$data.$withTooltip_tooltipEl=e,this.$data.$withTooltip_tooltipProps=r,this.$data.$withTooltip_tooltip=!0},$withTooltip_closeTooltip(){this.$data.$withTooltip_tooltip=!1,this.$data.$withTooltip_tooltipTimeout=setTimeout((()=>{this.$_withTooltip_clearTooltip()}),250)}}}}}]);